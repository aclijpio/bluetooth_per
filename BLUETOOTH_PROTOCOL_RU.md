# Bluetooth SPP Протокол - Документация

## Обзор

Данный документ описывает протокол взаимодействия между Flutter-клиентом и Android-сервером по Bluetooth SPP (Serial Port Profile).

## Архитектура

```
┌─────────────────┐    Bluetooth SPP    ┌─────────────────┐
│   Flutter App   │ ◄─────────────────► │  Android Server │
│   (Клиент)      │                     │   (Сервер)      │
└─────────────────┘                     └─────────────────┘
```

## Поддерживаемые команды

### 1. Обновление архива

| Команда | Направление | Описание |
|---------|-------------|----------|
| `UPDATE_ARCHIVE` | Клиент → Сервер | Запрос на обновление архива БД на сервере |
| `ARCHIVE_UPDATING` | Сервер → Клиент | Уведомление о начале обновления архива |
| `ARCHIVE_READY` | Сервер → Клиент | Уведомление о готовности архива |

### 2. Передача файлов

| Команда | Направление | Описание |
|---------|-------------|----------|
| `GET_FILE:<имя_файла>` | Клиент → Сервер | Запрос на скачивание файла |

## Формат данных

### Структура кадра
```
┌─────────────┬─────────────┐
│  2 байта    │   N байт    │
│   длина     │   данные    │
│ (big-endian)│  (UTF-8)    │
└─────────────┴─────────────┘
```

### Формат передачи файла
```
┌─────────────┬─────────────┬─────────────┐
│  1 байт     │   8 байт    │   N байт    │
│  success    │  fileSize   │  fileData   │
│  (boolean)  │   (long)    │   (bytes)   │
└─────────────┴─────────────┴─────────────┘
```
