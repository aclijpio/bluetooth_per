# Унифицированная архитектура интерфейса

## Обзор

Новая архитектура позволяет управлять всеми состояниями интерфейса на одной странице через единый `UnifiedInterfaceCubit`. Это обеспечивает плавные переходы между различными состояниями приложения без навигации между страницами.

## Основные компоненты

### 1. UnifiedInterfaceCubit
Центральный компонент для управления состояниями интерфейса.

**Состояния:**
- `initial` - Начальное состояние, готовность к поиску устройств
- `scanning` - Сканирование Bluetooth устройств
- `deviceSelection` - Выбор устройства из списка найденных
- `connected` - Подключено к устройству
- `fileList` - Получен список файлов
- `downloading` - Скачивание файла
- `webExport` - Веб-экспорт данных
- `error` - Ошибка

### 2. Универсальные виджеты

#### UnifiedDeviceCard
Карточка устройства с возможностью подключения.

#### UnifiedConnectionInfo
Информация о подключенном устройстве.

#### UnifiedFileCard
Карточка файла с возможностью скачивания.

#### UnifiedDownloadProgress
Прогресс-бар скачивания с детальной информацией.

#### UnifiedOperationsTable
Таблица операций для веб-экспорта в стиле Figma.

#### UnifiedDeviceInfoCard
Карточка с информацией об устройстве.

#### UnifiedContentArea
Основной контейнер, который отображает контент в зависимости от состояния.

#### UnifiedActionButton
Универсальная кнопка действий, которая меняет свой текст и поведение в зависимости от состояния.

#### UnifiedStatusIndicator
Индикатор текущего состояния интерфейса.

## Поток работы

1. **Начальное состояние** - Пользователь видит экран с кнопкой "Поиск устройств"
2. **Сканирование** - Приложение ищет Bluetooth устройства
3. **Выбор устройства** - Если найдено несколько устройств, пользователь выбирает одно
4. **Подключение** - Автоматическое подключение к устройству
5. **Список файлов** - Получение списка доступных файлов
6. **Скачивание** - Скачивание выбранного файла с отображением прогресса
7. **Веб-экспорт** - Работа с данными через веб-интерфейс

## Преимущества новой архитектуры

1. **Единая страница** - Все действия происходят на одном экране
2. **Плавные переходы** - Нет навигации между страницами
3. **Универсальные компоненты** - Виджеты переиспользуются в разных состояниях
4. **Централизованное управление** - Все состояния управляются через один Cubit
5. **Стилизация Figma** - Интерфейс соответствует дизайну из Figma

## Использование

```dart
// Изменение состояния
context.read<UnifiedInterfaceCubit>().setScanningState();

// Отслеживание состояния
BlocBuilder<UnifiedInterfaceCubit, UnifiedInterfaceState>(
  builder: (context, state) {
    switch (state.state) {
      case InterfaceState.scanning:
        return ScanningWidget();
      case InterfaceState.connected:
        return ConnectedWidget();
      // ...
    }
  },
)
```

## Интеграция с существующим кодом

Новая архитектура интегрируется с существующими:
- `BluetoothBloc` - для управления Bluetooth соединениями
- `OperationsCubit` - для работы с операциями
- `SendingCubit` - для отправки данных
- `MainData` - для хранения данных приложения

Все существующие функции сохранены, но теперь управляются через единый интерфейс. 